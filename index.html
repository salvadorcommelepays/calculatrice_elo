<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<title>Calculatrice Elo FIDE</title>

<style>
    body { font-family: Arial, sans-serif; background:#eef2f7; margin:0; }
    .container { max-width:1200px; margin:40px auto; background:white; padding:30px; border-radius:12px; box-shadow:0 0 20px rgba(0,0,0,0.1); }
    h1 { text-align:center; margin-bottom:25px; color:#333; font-size:32px; }
    table { width:100%; border-collapse:collapse; margin-bottom:20px; }
    th { background:#1976d2; color:white; padding:10px; }
    td { padding:10px; border-bottom:1px solid #ddd; text-align:center; }
    tr:nth-child(even) { background:#f4f6f8; }
    .section { margin-bottom:25px; background:#f8fafc; padding:15px; border-radius:8px; }
    input[type="number"], select, input[type="text"] { width:100%; padding:8px; border-radius:6px; border:1px solid #ccc; }
    label { font-weight:bold; display:block; margin-top:10px; }
    .elo-green { color:green; font-weight:bold; }
    .elo-red { color:red; font-weight:bold; }
    button { padding:10px 15px; background:#1976d2; color:white; border:none; border-radius:6px; cursor:pointer; font-size:16px; margin-right:10px; }
    button:hover { background:#0f5cad; }
    .flex-row {
    display: flex;
    justify-content: space-between;
    gap: 20px;
}
.table-new-elo {
    border: 3px solid red;
    border-radius: 8px;
}
.elo-box {
    width: 48%;
}
.flex-row-2 {
    display: flex;
    justify-content: space-between;
    gap: 25px;
    align-items: stretch;
}

.box-50 {
    width: 48%;
}
</style>
</head>

<body>
<div class="container">

<h1>Calculatrice Elo FIDE v16:53</h1>
<div class="flex-row">

    <div class="section elo-box">
        <h3>Élos initiaux (A REMPLIR)</h3>
        <table>
            <tr><th>Classique</th><th>Rapide</th><th>Blitz</th></tr>
            <tr>
                <td><input type="number" id="eloClassique"></td>
                <td><input type="number" id="eloRapide"></td>
                <td><input type="number" id="eloBlitz"></td>
            </tr>
        </table>
    </div>

   <div class="section elo-box">
    <h3>Nouveaux Élos</h3>
    <table class="table-new-elo">
            <tr><th>Classique</th><th>Rapide</th><th>Blitz</th></tr>
            <tr>
                <td id="newEloClassique">-</td>
                <td id="newEloRapide">-</td>
                <td id="newEloBlitz">-</td>
            </tr>
        </table>
    </div>

    </div>
<div class="flex-row-2">

    <!-- OPTIONS (COCHER SI CONCERNÉ) -->
    <div class="section box-50">
        <h3>Options</h3>

        <label><input type="checkbox" id="mineur"> Je suis né en 2007 ou après (2008-2025)</label>
        <label><input type="checkbox" class="is2400" value="classique"> J'ai déjà eu 2400 en Classique</label>
        <label><input type="checkbox" class="is2400" value="rapide"> J'ai déjà eu 2400 en Rapide</label>
        <label><input type="checkbox" class="is2400" value="blitz"> J'ai déjà eu 2400 en Blitz</label>
    </div>

    <!-- FONCTIONNEMENT -->
    <div class="section box-50" style="background:#fff7d6;border-left:4px solid #ffb300;">
        <h3>Fonctionnement</h3>
        <p style="margin:0;font-size:15px;">
            Veuillez entrer vos elos actuels dans le tableau en haut à gauche, cocher les options vous concernant et descendre  pour remplir les parties du mois <br><br>
            Attention : en cas de tournois joués à la fin du mois précédent, il se peut qu'un elo différent soit utilisé pour ces tournois précis. Nous vous recommandons de les calculer à part.
        </p>
    </div>

</div>
<h3>Parties du mois</h3>
<p style="margin-top:-10px;margin-bottom:15px;font-size:14px;color:#555;">
    Renseignez ici, une par une, les parties jouées pendant le mois sélectionné.
</p>

<table id="tableParties">
    <thead>
        <tr>
            <th>#</th>
            <th>Elo Adv</th>
            <th>Résultat</th>
            <th>Cadence</th>
            <th>Note</th>
            <th>E (proba)</th>
            <th>K</th>
            <th>Δ Elo</th>
            <th>Elo après</th>
        </tr>
    </thead>
    <tbody></tbody>
</table>

<button onclick="addRow()">Ajouter une partie</button>
<button onclick="calculate()">Recalculer</button>
<button onclick="resetTable()">Réinitialiser</button>
<div class="flex-row-2">
    
    <div class="section box-50">
        <h3>Nombre de parties</h3>
        <table>
            <tr><th>Classique</th><th>Rapide</th><th>Blitz</th></tr>
            <tr>
                <td id="nbClassique">0</td>
                <td id="nbRapide">0</td>
                <td id="nbBlitz">0</td>
            </tr>
        </table>
    </div>

    <div class="section box-50">
        <h3>Coefficients K</h3>
        <table>
            <tr><th>Classique</th><th>Rapide</th><th>Blitz</th></tr>
            <tr>
                <td id="kClassique">-</td>
                <td id="kRapide">-</td>
                <td id="kBlitz">-</td>
            </tr>
        </table>
    </div>

</div>


<script>
let count = 0;

function computeK(cadence, n, mineur, list2400) {
    if (list2400.includes(cadence)) return 10;
    let base = mineur ? 40 : 20;
    if (n === 0) return base;
    return Math.max(10, Math.min(base, Math.floor(700 / n)));
}

function updateCounts() {
    let rows = document.querySelectorAll("#tableParties tbody tr");
    let c = {classique:0, rapide:0, blitz:0};
    rows.forEach(r => c[r.querySelector(".cadence").value]++);
    nbClassique.textContent = c.classique;
    nbRapide.textContent = c.rapide;
    nbBlitz.textContent = c.blitz;
}

function addRow() {
    count++;
    let tr = document.createElement("tr");
    tr.innerHTML = `
        <td>${count}</td>
        <td><input type="number" class="eloAdv"></td>
        <td><select class="resultat"><option value="1">Victoire</option><option value="0.5">Nul</option><option value="0">Défaite</option></select></td>
        <td><select class="cadence"><option value="classique">Classique</option><option value="rapide">Rapide</option><option value="blitz">Blitz</option></select></td>
        <td><input type="text" class="note"></td>
        <td class="E"></td>
        <td class="K"></td>
        <td class="delta"></td>
        <td class="eloApres"></td>
    `;
    tableParties.querySelector("tbody").appendChild(tr);

    tr.querySelector(".cadence").addEventListener("change", calculate);
    calculate();
}

function calculate() {
    updateCounts();

    // valeurs des checkboxes
    let mineurVal = mineur.checked;
    let list2400 = Array.from(document.querySelectorAll(".is2400:checked")).map(x => x.value);

    // comptage des parties par cadence
    let rows = document.querySelectorAll("#tableParties tbody tr");
    let countCad = {classique:0, rapide:0, blitz:0};
    rows.forEach(r => countCad[r.querySelector(".cadence").value]++);

    // calcul des coefficients K par cadence
    let kC = computeK("classique", countCad.classique, mineurVal, list2400);
    let kR = computeK("rapide", countCad.rapide, mineurVal, list2400);
    let kB = computeK("blitz", countCad.blitz, mineurVal, list2400);

    kClassique.textContent = kC;
    kRapide.textContent = kR;
    kBlitz.textContent = kB;

    // Élos initiaux
    let base = {
        classique: parseInt(eloClassique.value) || 0,
        rapide: parseInt(eloRapide.value) || 0,
        blitz: parseInt(eloBlitz.value) || 0
    };

    let cur = {...base};

    // calcul partie par partie
    rows.forEach(r => {
        let adv = parseInt(r.querySelector(".eloAdv").value);
        if (isNaN(adv)) return;

        let S = parseFloat(r.querySelector(".resultat").value);
        let cad = r.querySelector(".cadence").value;

        let K = cad === "classique" ? kC : cad === "rapide" ? kR : kB;

        let E = 1 / (1 + Math.pow(10, (adv - cur[cad]) / 400));
        r.querySelector(".E").textContent = E.toFixed(3);
        r.querySelector(".K").textContent = K;

        let d = Math.round(K * (S - E));
        r.querySelector(".delta").textContent = d;

        cur[cad] += d;
        r.querySelector(".eloApres").textContent = cur[cad];
    });

    // mise à jour affichage final
    newEloClassique.innerHTML = cur.classique >= base.classique ? `<span class="elo-green">${cur.classique}</span>` : `<span class="elo-red">${cur.classique}</span>`;
    newEloRapide.innerHTML    = cur.rapide   >= base.rapide   ? `<span class="elo-green">${cur.rapide}</span>`   : `<span class="elo-red">${cur.rapide}</span>`;
    newEloBlitz.innerHTML     = cur.blitz    >= base.blitz    ? `<span class="elo-green">${cur.blitz}</span>`    : `<span class="elo-red">${cur.blitz}</span>`;
}

function resetTable() {
    tableParties.querySelector("tbody").innerHTML = "";
    count = 0;
    nbClassique.textContent = 0;
    nbRapide.textContent = 0;
    nbBlitz.textContent = 0;
    newEloClassique.textContent = "-";
    newEloRapide.textContent = "-";
    newEloBlitz.textContent = "-";
}
</script>


</body>
</html>




















