<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<title>Calculatrice Elo</title>

<style>
    body { font-family: Arial, sans-serif; background:#eef2f7; margin:0; }
    .container { max-width:1200px; margin:40px auto; background:white; padding:30px; border-radius:12px; box-shadow:0 0 20px rgba(0,0,0,0.1); }

    h1 { text-align:center; margin-bottom:25px; color:#333; font-size:32px; }

    table { width:100%; border-collapse:collapse; margin-bottom:20px; }
    th { background:#1976d2; color:white; padding:10px; }
    td { padding:10px; border-bottom:1px solid #ddd; text-align:center; }
    tr:nth-child(even) { background:#f4f6f8; }

    input, select { width:100%; padding:8px; border-radius:6px; border:1px solid #ccc; }
    label { font-weight:bold; display:block; margin-top:6px; }

    button {
        width:100%; padding:15px; background:#1976d2; color:white;
        border:none; border-radius:8px; cursor:pointer; font-size:16px; 
        margin-bottom:15px;
    }
    button:hover { background:#0f5cad; }

    .section { background:#f8fafc; padding:15px; border-radius:8px; }

    /* LAYOUT LIGNES */
    .row { display:flex; justify-content:space-between; gap:25px; margin-bottom:35px; }
    .col-50 { width:48%; }
    .col-30 { width:20%; }
    .col-70 { width:68%; }

    .small-box { width:48%; }

    .table-new-elo { border:3px solid red; border-radius:8px; }
    .options-box input[type="checkbox"] {
    margin-left:140px; 
}
</style>
</head>

<body>
<div class="container">

<h1>Calculatrice Elo v26.11.2025 18:00</h1>

<!-- ========= LIGNE 1 — Élos initiaux + Nouveaux Élos ========= -->
<div class="row">
    <div class="section col-50">
        <h3>Élos initiaux</h3>
        <table>
            <tr><th>Classique</th><th>Rapide</th><th>Blitz</th></tr>
            <tr>
                <td><input type="number" id="eloClassique"></td>
                <td><input type="number" id="eloRapide"></td>
                <td><input type="number" id="eloBlitz"></td>
            </tr>
        </table>
    </div>

    <div class="section col-50">
        <h3>Nouveaux Élos</h3>
        <table class="table-new-elo">
            <tr><th>Classique</th><th>Rapide</th><th>Blitz</th></tr>
            <tr>
                <td id="newEloClassique">-</td>
                <td id="newEloRapide">-</td>
                <td id="newEloBlitz">-</td>
            </tr>
        </table>
    </div>
</div>

<!-- ========= LIGNE 2 — Options + Parties du mois ========= -->
<div class="row">

    <!-- Options -->
   <div class="section col-30 options-box">
        <h3>Options</h3>
        <label><input type="checkbox" id="mineur"> Je suis né en 2007 ou après</label>
        <label><input type="checkbox" class="is2400" value="classique"> Déjà eu 2400 en Lent</label>
        <label><input type="checkbox" class="is2400" value="rapide"> Déjà eu 2400 en Rapide</label>
        <label><input type="checkbox" class="is2400" value="blitz"> Déjà eu 2400 en Blitz</label>
    </div>

    <!-- Parties du mois -->
    <div class="col-70">
        <h3>Parties du mois</h3>

        <table id="tableParties">
            <thead>
                <tr>
                    <th>#</th>
                    <th>Elo Adv</th>
                    <th>Résultat</th>
                    <th>Cadence</th>
                    <th>E</th>
                    <th>K</th>
                    <th>Δ</th>
                    <th>Elo après</th>
                </tr>
            </thead>
            <tbody></tbody>
        </table>

        <button onclick="addRow()">Ajouter une partie</button>
        <button onclick="resetTable()">Réinitialiser</button>
    </div>

</div>

<!-- ========= LIGNE 3 — Nombre de parties + Coefficients ========= -->
<div class="row">
    <div class="section small-box">
        <h3>Nombre de parties</h3>
        <table>
            <tr><th>Classique</th><th>Rapide</th><th>Blitz</th></tr>
            <tr>
                <td id="nbClassique">0</td>
                <td id="nbRapide">0</td>
                <td id="nbBlitz">0</td>
            </tr>
        </table>
    </div>

    <div class="section small-box">
        <h3>Coefficients K</h3>
        <table>
            <tr><th>Classique</th><th>Rapide</th><th>Blitz</th></tr>
            <tr>
                <td id="kClassique">-</td>
                <td id="kRapide">-</td>
                <td id="kBlitz">-</td>
            </tr>
        </table>
    </div>
</div>

<script>
let count=0;

function computeK(c,n,m,list2400){
    if(list2400.includes(c))return 10;
    let b=m?40:20;
    if(n===0)return b;
    return Math.max(10,Math.min(b,Math.floor(700/n)));
}

function updateCounts(){
    let rows=document.querySelectorAll("#tableParties tbody tr");
    let c={classique:0,rapide:0,blitz:0};
    rows.forEach(r=>c[r.querySelector(".cadence").value]++);
    nbClassique.textContent=c.classique;
    nbRapide.textContent=c.rapide;
    nbBlitz.textContent=c.blitz;
}

function addRow(){
    count++;
    let tr=document.createElement("tr");
    tr.innerHTML=`
        <td>${count}</td>
        <td><input type="number" class="eloAdv"></td>
        <td><select class="resultat"><option value="1">Victoire</option><option value="0.5">Nul</option><option value="0">Défaite</option></select></td>
        <td><select class="cadence"><option value="classique">Classique</option><option value="rapide">Rapide</option><option value="blitz">Blitz</option></select></td>
        <td class="E"></td>
        <td class="K"></td>
        <td class="delta"></td>
        <td class="eloApres"></td>
    `;
    tableParties.querySelector("tbody").appendChild(tr);
    tr.querySelectorAll("input,select").forEach(el=>el.addEventListener("input",calculate));
    calculate();
}

function calculate(){
    updateCounts();

    let m=mineur.checked;
    let list2400=Array.from(document.querySelectorAll(".is2400:checked")).map(x=>x.value);

    let rows=document.querySelectorAll("#tableParties tbody tr");
    let countCad={classique:0,rapide:0,blitz:0};
    rows.forEach(r=>countCad[r.querySelector(".cadence").value]++);

    let kC=computeK("classique",countCad.classique,m,list2400);
    let kR=computeK("rapide",countCad.rapide,m,list2400);
    let kB=computeK("blitz",countCad.blitz,m,list2400);

    kClassique.textContent=kC;
    kRapide.textContent=kR;
    kBlitz.textContent=kB;

    let base={
        classique:parseInt(eloClassique.value)||0,
        rapide:parseInt(eloRapide.value)||0,
        blitz:parseInt(eloBlitz.value)||0
    };

    let cur={...base};

    rows.forEach(r=>{
        let adv=parseInt(r.querySelector(".eloAdv").value);
        if(isNaN(adv))return;
        let S=parseFloat(r.querySelector(".resultat").value);
        let cad=r.querySelector(".cadence").value;
        let K=cad==="classique"?kC:cad==="rapide"?kR:kB;
        let E=1/(1+Math.pow(10,(adv-cur[cad])/400));
        r.querySelector(".E").textContent=E.toFixed(3);
        r.querySelector(".K").textContent=K;
       let d = K * (S - E);
        r.querySelector(".delta").textContent = d.toFixed(1);
        cur[cad]+=d;
        r.querySelector(".eloApres").textContent=cur[cad];
    });

    newEloClassique.textContent=cur.classique;
    newEloRapide.textContent=cur.rapide;
    newEloBlitz.textContent=cur.blitz;
}

function resetTable(){
    tableParties.querySelector("tbody").innerHTML="";
    count=0;
    nbClassique.textContent=0;
    nbRapide.textContent=0;
    nbBlitz.textContent=0;
    kClassique.textContent="-";
    kRapide.textContent="-";
    kBlitz.textContent="-";
    newEloClassique.textContent="-";
    newEloRapide.textContent="-";
    newEloBlitz.textContent="-";
}

eloClassique.addEventListener("input",calculate);
eloRapide.addEventListener("input",calculate);
eloBlitz.addEventListener("input",calculate);
mineur.addEventListener("change",calculate);
document.querySelectorAll(".is2400").forEach(cb=>cb.addEventListener("change",calculate));
</script>

</body>
</html>













